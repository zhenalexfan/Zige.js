var CLASS_NAME="zige",SPAN_ATTR_NAME="zige-margin",DEFAULT_AUTO_MARGIN_SIZE="0.25em",CJK_SCRIPT=/[\u4e00-\u9ffc\uf900-\ufaff\u2f00-\u2fdf\u31c0-\u31ef\u1100-\u11ff\ua700-\ud7af\u3040-\u309f\u30a0-\u31ff]/,CJK_SYMBOL=/[\u2000-\u206f\u3000-\u303f\ufe30-\ufe4f\uff00-\uffef\ufe10-\ufe1f]/,ALPHABET_SCRIPT=/[\u0030-\u0039\u0041-\u005a\u0061-\u007a]/,ALPHABET_SYMBOL=/[\u0021-\u007e\u2000-\u206f]/;class AlphabetSpan{constructor(node,startOffset,endOffset,leftSpaceEnabled,rightSpaceEnabled){this.node=node,this.startOffset=startOffset,this.endOffset=endOffset,this.leftSpaceEnabled=leftSpaceEnabled,this.rightSpaceEnabled=rightSpaceEnabled}get text(){return this.node.textContent.slice(this.startOffset,this.endOffset)}createSpanElement(){var spanElem=document.createElement("span"),kbType=String();return this.leftSpaceEnabled&&(kbType+="l"),this.rightSpaceEnabled&&(kbType+="r"),spanElem.setAttribute(SPAN_ATTR_NAME,kbType),spanElem.innerHTML=this.text,spanElem}}class CharacterType{static isAlphabetScript(character){return null!=character.match(ALPHABET_SCRIPT)}static isCJKScript(character){return null!=character.match(CJK_SCRIPT)}static isAlphabetSymbol(character){return null!=character.match(ALPHABET_SYMBOL)}static isCJKSymbol(character){return null!=character.match(CJK_SYMBOL)}static isAlphabet(character){return this.isAlphabetScript(character)||this.isAlphabetSymbol(character)}static isCJK(character){return this.isCJKScript(character)||this.isCJKSymbol(character)}}function getOrderedLeafNodes(master){var results=[];if(1==master.nodeType&&master.hasChildNodes){for(var children=master.childNodes,i=0;i<children.length;i++){var childLeafs=getOrderedLeafNodes(children[i]);results=results.concat(childLeafs)}return results}return 3==master.nodeType?(results.push(master),results):results}function findAlphabetSpans(textNode,previousLeafNode,nextLeafNode){for(var result=[],textContent=textNode.textContent,i=0;i<textContent.length;i++){var character=textContent[i];if(CharacterType.isAlphabetScript(character)){for(var startOffset=i;i<textContent.length;i++){var followingCharacter=textContent[i];if(!CharacterType.isAlphabet(followingCharacter)||CharacterType.isCJK(followingCharacter))break}var endOffset=i,leftIsCJKScript=!1,rightIsCJKScript=!1;startOffset>0?leftIsCJKScript=CharacterType.isCJKScript(textContent[startOffset-1]):null!=previousLeafNode&&previousLeafNode.textContent.length>0&&(leftIsCJKScript=CharacterType.isCJKScript(previousLeafNode.textContent[previousLeafNode.textContent.length-1])),endOffset<textContent.length?rightIsCJKScript=CharacterType.isCJKScript(textContent[endOffset]):null!=nextLeafNode&&nextLeafNode.textContent.length>0&&(rightIsCJKScript=CharacterType.isCJKScript(nextLeafNode.textContent[0])),result.push(new AlphabetSpan(textNode,startOffset,endOffset,leftIsCJKScript,rightIsCJKScript))}}return result}function beautifyNode(node,alphabetSpans){if(0!=alphabetSpans.length){for(var replacementSpans=[],text=node.textContent,curOffset=0,i=0;i<alphabetSpans.length;i++){var span=alphabetSpans[i];if(span.leftSpaceEnabled||span.rightSpaceEnabled){if(span.startOffset>curOffset){var rTextNode=document.createTextNode(text.slice(curOffset,span.startOffset));replacementSpans.push(rTextNode)}replacementSpans.push(span.createSpanElement()),curOffset=span.endOffset}}if(text.length>curOffset){rTextNode=document.createTextNode(text.slice(curOffset,text.length));replacementSpans.push(rTextNode)}replacementSpans.forEach(function(span){node.parentNode.insertBefore(span,node)}),node.parentNode.removeChild(node)}}function beautify(master){for(var leafNodes=getOrderedLeafNodes(master),i=0;i<leafNodes.length;i++){var leaf=leafNodes[i];if(leaf.textContent.trim())if(CharacterType.isAlphabetScript(leaf.textContent.trim()))beautifyNode(leaf,findAlphabetSpans(leaf,i>0?leafNodes[i-1]:null,i<=leafNodes.length?leafNodes[i+1]:null))}}function addCSS(className=CLASS_NAME,marginSize=DEFAULT_AUTO_MARGIN_SIZE){var classSelector=className?`.${CLASS_NAME}`:String(),cssRule=`${classSelector} span[${SPAN_ATTR_NAME}^='l'] { margin-left: ${marginSize}; }`;cssRule+=`${classSelector} span[${SPAN_ATTR_NAME}$='r'] { margin-right: ${marginSize}; }`;var styleElem=document.createElement("style");styleElem.type="text/css",styleElem.styleSheet?CSS.styleSheet.cssText=cssRule:styleElem.appendChild(document.createTextNode(cssRule)),document.getElementsByTagName("head")[0].appendChild(styleElem)}window.addEventListener("load",function(){var elements=this.document.getElementsByClassName(CLASS_NAME),className=CLASS_NAME;if(elements.length>0)for(var i=0;i<elements.length;i++)beautify(elements[i]);else beautify(this.document.body),className=null;addCSS(className)});